<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swiss Flag Component</title>

  <script type="module" src="../src/swiss-flag.js"></script>
  <style>
    :root {
      --border: #e5e7eb;
      --text: #374151;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #ffffff;
      color: var(--text);
    }

    #app {
      max-inline-size: 600px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }

    .controls-container {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      margin-bottom: 3rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .primary-toggles {
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      user-select: none;
    }

    .size-control {
      margin-bottom: 0.5rem;
    }

    .size-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .size-value {
      color: #666;
    }

    input[type="range"] {
      inline-size: 100%;
      display: block;
    }

    .manual-settings-section {
      border-top: 1px solid #e5e7eb;
      padding-top: 1.5rem;
    }

    .manual-controls {
      display: grid;
      gap: 1rem;
      padding-inline-start: 0.5rem;
      transition: opacity 0.2s;
    }

    .manual-label-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.25rem;
      font-size: 0.85rem;
    }

    .manual-value {
      color: #666;
    }

    .preset-message {
      color: #666;
      font-size: 0.9rem;
      font-style: italic;
      padding-inline-start: 1.8rem;
      margin-block-end: 1rem;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .credits {
      visibility: hidden;
      position: absolute;

      bottom: 0;
      left: 50%;
      inline-size: 95%;
      margin: 0;
      padding: 8px 16px;
      transform: translateX(-50%) translateY(50%);
      border: 1px solid var(--border);
      border-radius: 8px;
      background-color: rgba(255, 255, 255, 0.9);
      box-shadow: 0 2px 8px var(--border);
      color: var(--text);
      font-size: 0.9rem;
      text-align: center;
      opacity: 0;
      transition:
        opacity 0.2s ease-in-out,
        visibility 0.2s;

      z-index: 100;
    }

    swiss-flag:hover .credits,
    .credits:hover {
      visibility: visible;
      opacity: 1;
      transition-delay: 0s;
    }

    swiss-flag {
      display: block;
      inline-size: 100%;
      block-size: 100%;
      margin-inline: auto;
    }

    .code-sample-container {
      background: #2d2d2d;
      color: #e0e0e0;
      padding: 1.5rem;
      border-radius: 8px;
      overflow-x: auto;
      font-family: Consolas, Monaco, 'Andale Mono', monospace;
      font-size: 0.9rem;
      line-height: 1.5;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    }

    .code-sample-container pre {
      margin: 0;
    }

    .token-tag {
      color: #569cd6;
    }

    .token-attr-name {
      color: #9cdcfe;
    }

    .token-attr-value {
      color: #ce9178;
    }

    .token-punctuation {
      color: #808080;
    }

    .token-text {
      color: #d4d4d4;
    }

    a {
      color: inherit;
      text-decoration: none;
      border-bottom: 1px solid #ccc;
    }

    .github-repo {
      text-align: center;
      margin-block-start: 2rem;
      font-size: 0.9rem;
      color: #666;
    }

    h3 {
      margin-block-start: 3rem;
      text-align: center;
    }

    .flag-description {
      font-style: italic;
      color: #555;
    }
  </style>
</head>

<body>
  <div id="app">
    <h1>Swiss Flag</h1>

    <div class="controls-container">
      <div class="primary-toggles">
        <label>
          <input type="checkbox" id="reduce-motion">
          Reduce Motion
        </label>
        <label>
          <input type="checkbox" id="no-animation">
          No Animation
        </label>
        <label>
          <input type="checkbox" id="show-slot">
          Show Slot Content
        </label>
      </div>

      <div class="size-control">
        <div class="size-header">
          Size <span id="size-display" class="size-value">12rem</span>
        </div>
        <input type="range" id="size-slider" min="2" max="50" value="12">
      </div>

      <div class="manual-settings-section">
        <label style="margin-bottom: 1rem; font-weight: 500;">
          <input type="checkbox" id="override-animation">
          Override Animation Settings
        </label>

        <div id="preset-message" class="preset-message">
          Using "Standard" preset (600ms speed, 2% distance, 50ms stagger)
        </div>

        <div id="manual-controls" class="manual-controls">
          <div>
            <div class="manual-label-header">
              Animation Speed <span id="speed-display" class="manual-value">600ms</span>
            </div>
            <input type="range" id="speed-slider" min="100" max="3000" step="50" value="600">
          </div>

          <div>
            <div class="manual-label-header">
              Oscillation Distance <span id="distance-display" class="manual-value">2%</span>
            </div>
            <input type="range" id="distance-slider" min="0" max="10" step="0.1" value="2">
          </div>

          <div>
            <div class="manual-label-header">
              Stagger Delay <span id="stagger-display" class="manual-value">50ms</span>
            </div>
            <input type="range" id="stagger-slider" min="0" max="200" step="5" value="50">
          </div>
        </div>
      </div>

      <div class="manual-settings-section">
        <label style="margin-bottom: 1rem; font-weight: 500;">
          <input type="checkbox" id="override-reduced">
          Override Reduced Settings
        </label>

        <div id="reduced-preset-message" class="preset-message">
          Using "Reduced" defaults (900ms speed, 2% distance, 0ms stagger)
        </div>

        <div id="reduced-manual-controls" class="manual-controls" style="opacity: 0.5;">
          <div>
            <div class="manual-label-header">
              Reduced Speed <span id="reduced-speed-display" class="manual-value">900ms</span>
            </div>
            <input type="range" id="reduced-speed-slider" min="100" max="3000" step="50" value="900" disabled>
          </div>

          <div>
            <div class="manual-label-header">
              Reduced Distance <span id="reduced-distance-display" class="manual-value">2%</span>
            </div>
            <input type="range" id="reduced-distance-slider" min="0" max="10" step="0.1" value="2" disabled>
          </div>

          <div>
            <div class="manual-label-header">
              Reduced Stagger <span id="reduced-stagger-display" class="manual-value">0ms</span>
            </div>
            <input type="range" id="reduced-stagger-slider" min="0" max="200" step="5" value="0" disabled>
          </div>
        </div>
      </div>
    </div>

    <swiss-flag style="inline-size: 12rem;">
    </swiss-flag>

    <h3>Code Sample</h3>
    <div class="code-sample-container">
      <pre><code id="code-sample"></code></pre>
    </div>

    <div class="github-repo">
      <a href="https://github.com/Khoding/swiss-flag" target="_blank">
        View on GitHub and use the Swiss Flag Web Component in your projects!
      </a>
    </div>

    <div class="explanation">
      <h3>Additional stuff</h3>
      <p>
        The Swiss Flag component follows closely the design of the official Swiss flag. It is defined as such: <span
          class="flag-description">
          "a
          white, upright, free-standing cross depicted against a red background, whose arms, which are all of equal
          size,
          are one-sixth longer than they are wide."
        </span>
      </p>
      <p>
        The official color of the flag is <a href="https://www.pantone.com/color-finder/485-C" target="_blank">Pantone
          485C</a>, a color
        that cannot properly be depicted on most screens (except
        <em>maybe</em>
        Pantone Validated ones, but they are not common). For this reason, it has been determined in 2007 that the
        official "digital" red for the Swiss Flag be <code>#FF0000</code>, the color used for this component.
      </p>

      <ul>
        <li>
          <a href="https://en.wikipedia.org/wiki/Flag_of_Switzerland" target="_blank">Flag of Switzerland on
            Wikipedia</a>
        </li>
        <li>
          <a href="https://www.aboutswitzerland.eda.admin.ch/en/swiss-flag" target="_blank">Swiss Flag on admin.ch</a>
        </li>
      </ul>
    </div>
  </div>

  <script>
    const state = {
      reduceAnimation: false,
      removeAnimation: false,
      showSlot: false,
      size: 12,
      overrideAnimation: false,
      speed: 600,
      distance: 2,
      stagger: 50,
      overrideReduced: false,
      reducedSpeed: 900,
      reducedDistance: 2,
      reducedStagger: 0
    };

    const reduceMotionCheckbox = document.getElementById('reduce-motion');
    const noAnimationCheckbox = document.getElementById('no-animation');
    const showSlotCheckbox = document.getElementById('show-slot');
    const sizeSlider = document.getElementById('size-slider');
    const sizeDisplay = document.getElementById('size-display');
    const overrideCheckbox = document.getElementById('override-animation');
    const manualControls = document.getElementById('manual-controls');
    const presetMessage = document.getElementById('preset-message');
    const speedSlider = document.getElementById('speed-slider');
    const speedDisplay = document.getElementById('speed-display');
    const distanceSlider = document.getElementById('distance-slider');
    const distanceDisplay = document.getElementById('distance-display');
    const staggerSlider = document.getElementById('stagger-slider');
    const staggerDisplay = document.getElementById('stagger-display');

    const overrideReducedCheckbox = document.getElementById('override-reduced');
    const reducedManualControls = document.getElementById('reduced-manual-controls');
    const reducedPresetMessage = document.getElementById('reduced-preset-message');
    const reducedSpeedSlider = document.getElementById('reduced-speed-slider');
    const reducedSpeedDisplay = document.getElementById('reduced-speed-display');
    const reducedDistanceSlider = document.getElementById('reduced-distance-slider');
    const reducedDistanceDisplay = document.getElementById('reduced-distance-display');
    const reducedStaggerSlider = document.getElementById('reduced-stagger-slider');
    const reducedStaggerDisplay = document.getElementById('reduced-stagger-display');

    const swissFlag = document.querySelector('swiss-flag');
    const credits = document.createElement('div');
    credits.className = 'credits';
    credits.innerHTML = 'ðŸ‡¨ðŸ‡­ Swiss <a href="#">Engineering</a>';
    const codeSample = document.getElementById('code-sample');

    function highlightAttr(name, value) {
      if (value === undefined) {
        return `<span class="token-attr-name">${name}</span>`;
      }
      return `<span class="token-attr-name">${name}</span><span class="token-punctuation">=</span><span class="token-attr-value">"${value}"</span>`;
    }

    function updateCodeSample() {
      const attributes = [];
      attributes.push(highlightAttr('style', `inline-size: ${state.size}rem;`));

      if (state.reduceAnimation) attributes.push(highlightAttr('reduce-animation'));
      if (state.removeAnimation) attributes.push(highlightAttr('remove-animation'));

      if (state.overrideAnimation) {
        attributes.push(highlightAttr('animation-speed', state.speed));
        attributes.push(highlightAttr('oscillate-distance', `${state.distance}%`));
        attributes.push(highlightAttr('staggered-delay', state.stagger));
      }

      if (state.overrideReduced) {
        attributes.push(highlightAttr('reduced-animation-speed', state.reducedSpeed));
        attributes.push(highlightAttr('reduced-oscillate-distance', `${state.reducedDistance}%`));
        attributes.push(highlightAttr('reduced-staggered-delay', state.reducedStagger));
      }

      const attrString = attributes.length > 0 ? ' ' + attributes.join('\n  ') : '';

      const swissFlagOpen = `<span class="token-punctuation">&lt;</span><span class="token-tag">swiss-flag</span>${attrString}<span class="token-punctuation">&gt;</span>`;
      const swissFlagClose = `<span class="token-punctuation">&lt;/</span><span class="token-tag">swiss-flag</span><span class="token-punctuation">&gt;</span>`;

      const divAttr = highlightAttr('class', 'credits');
      const divOpen = `<span class="token-punctuation">&lt;</span><span class="token-tag">div</span> ${divAttr}<span class="token-punctuation">&gt;</span>`;
      const divClose = `<span class="token-punctuation">&lt;/</span><span class="token-tag">div</span><span class="token-punctuation">&gt;</span>`;

      const aAttrs = [
        highlightAttr('href', '#'),
      ].join(' ');
      const aOpen = `<span class="token-punctuation">&lt;</span><span class="token-tag">a</span> ${aAttrs}<span class="token-punctuation">&gt;</span>`;
      const aClose = `<span class="token-punctuation">&lt;/</span><span class="token-tag">a</span><span class="token-punctuation">&gt;</span>`;

      // Content
      let flagText = '';
      if (state.showSlot) {
        flagText = '\n  ' + divOpen + '\n    ðŸ‡¨ðŸ‡­ Swiss ' + aOpen + 'Engineering' + aClose + '\n  ' + divClose + '\n';
      }

      codeSample.innerHTML = swissFlagOpen + flagText + swissFlagClose;
    }

    function updateUI() {
      if (state.reduceAnimation) {
        swissFlag.setAttribute('reduce-animation', '');
      } else {
        swissFlag.removeAttribute('reduce-animation');
      }

      if (state.removeAnimation) {
        swissFlag.setAttribute('remove-animation', '');
      } else {
        swissFlag.removeAttribute('remove-animation');
      }

      if (state.overrideAnimation) {
        swissFlag.setAttribute('animation-speed', state.speed);
        swissFlag.setAttribute('oscillate-distance', state.distance + '%');
        swissFlag.setAttribute('staggered-delay', state.stagger);

        speedSlider.disabled = false;
        distanceSlider.disabled = false;
        staggerSlider.disabled = false;
        manualControls.style.opacity = '1';
      } else {
        swissFlag.removeAttribute('animation-speed');
        swissFlag.removeAttribute('oscillate-distance');
        swissFlag.removeAttribute('staggered-delay');

        speedSlider.disabled = true;
        distanceSlider.disabled = true;
        staggerSlider.disabled = true;
        manualControls.style.opacity = '0.5';

        // Reset to Standard defaults
        state.speed = 600;
        state.distance = 2;
        state.stagger = 50;

        speedSlider.value = state.speed;
        distanceSlider.value = state.distance;
        staggerSlider.value = state.stagger;
      }

      if (state.overrideReduced) {
        swissFlag.setAttribute('reduced-animation-speed', state.reducedSpeed);
        swissFlag.setAttribute('reduced-oscillate-distance', state.reducedDistance + '%');
        swissFlag.setAttribute('reduced-staggered-delay', state.reducedStagger);

        reducedSpeedSlider.disabled = false;
        reducedDistanceSlider.disabled = false;
        reducedStaggerSlider.disabled = false;
        reducedManualControls.style.opacity = '1';
      } else {
        swissFlag.removeAttribute('reduced-animation-speed');
        swissFlag.removeAttribute('reduced-oscillate-distance');
        swissFlag.removeAttribute('reduced-staggered-delay');

        reducedSpeedSlider.disabled = true;
        reducedDistanceSlider.disabled = true;
        reducedStaggerSlider.disabled = true;
        reducedManualControls.style.opacity = '0.5';

        // Reset to Reduced defaults
        state.reducedSpeed = 900;
        state.reducedDistance = 2;
        state.reducedStagger = 35;

        reducedSpeedSlider.value = state.reducedSpeed;
        reducedDistanceSlider.value = state.reducedDistance;
        reducedStaggerSlider.value = state.reducedStagger;
      }

      swissFlag.style.inlineSize = `${state.size}rem`;
      sizeDisplay.textContent = `${state.size}rem`;

      speedDisplay.textContent = `${state.speed}ms`;
      distanceDisplay.textContent = `${state.distance}%`;
      staggerDisplay.textContent = `${state.stagger}ms`;

      reducedSpeedDisplay.textContent = `${state.reducedSpeed}ms`;
      reducedDistanceDisplay.textContent = `${state.reducedDistance}%`;
      reducedStaggerDisplay.textContent = `${state.reducedStagger}ms`;

      presetMessage.textContent = 'Using "Standard" defaults (600ms speed, 2% distance, 50ms stagger)';
      reducedPresetMessage.textContent = 'Using "Reduced" defaults (900ms speed, 2% distance, 35ms stagger)';

      if (state.showSlot) {
        if (!swissFlag.contains(credits)) {
          swissFlag.appendChild(credits);
        }
        credits.style.display = '';
      } else {
        if (swissFlag.contains(credits)) {
          credits.remove();
        }
      }

      updateCodeSample();
    }

    reduceMotionCheckbox.addEventListener('change', (e) => {
      const isChecked = e.target.checked;
      const wasRemoved = state.removeAnimation;
      state.removeAnimation = true;
      state.reduceAnimation = isChecked;
      updateUI();

      setTimeout(() => {
        state.removeAnimation = wasRemoved;
        updateUI();
      }, 10);
    });

    noAnimationCheckbox.addEventListener('change', (e) => {
      state.removeAnimation = e.target.checked;
      updateUI();
    });

    showSlotCheckbox.addEventListener('change', (e) => {
      state.showSlot = e.target.checked;
      updateUI();
    });

    sizeSlider.addEventListener('input', (e) => {
      state.size = e.target.value;
      updateUI();
    });

    overrideCheckbox.addEventListener('change', (e) => {
      state.overrideAnimation = e.target.checked;
      updateUI();
    });

    speedSlider.addEventListener('input', (e) => {
      state.speed = Number(e.target.value);
      updateUI();
    });

    distanceSlider.addEventListener('input', (e) => {
      state.distance = Number(e.target.value);
      updateUI();
    });

    staggerSlider.addEventListener('input', (e) => {
      state.stagger = Number(e.target.value);
      updateUI();
    });

    overrideReducedCheckbox.addEventListener('change', (e) => {
      state.overrideReduced = e.target.checked;
      updateUI();
    });

    reducedSpeedSlider.addEventListener('input', (e) => {
      state.reducedSpeed = Number(e.target.value);
      updateUI();
    });

    reducedDistanceSlider.addEventListener('input', (e) => {
      state.reducedDistance = Number(e.target.value);
      updateUI();
    });

    reducedStaggerSlider.addEventListener('input', (e) => {
      state.reducedStagger = Number(e.target.value);
      updateUI();
    });

    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    if (mediaQuery.matches) {
      // updateUI will handle this if we set defaults or if we read it here
      // For now, let's just respect the manual toggles starting at false/false
    }

    updateUI();
  </script>
</body>

</html>
